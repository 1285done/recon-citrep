{%include "headers.njk"%}

<body>
	{%include "navbar.njk"%}
	<div class="container">
		<div class="row">
			<button class="btn btn-primary my-2" data-toggle="modal" data-target="#search" accesskey="s">Search</button>
			<div role="dialog" tabindex="-1" class="modal fade" id="search">
				<div class="modal-dialog modal-lg" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title">Structure Search</h4>
							<button type="button" class="close " data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">x</span>
							</button>
						</div>
						<div class="modal-body">
							<form action='/search' method='post'>
								<div class="row">
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="system">System:</label>
											<input type="text" id="system" name="system" class="form-control">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="region">Region:</label>
											<input type="text" id="region" name="region" class="form-control">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="constellation">Constellation:</label>
											<input type="text" id="constellation" name="constellation" class="form-control">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="citname">Name:</label>
											<input type='text' name='citname' class="form-control" id="citname">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="cittype">Type:</label>
											<select name='type' class="form-control" id="cittype">
												<option value="All">All</option>
												<option value="Astrahus">Astrahus</option>
												<option value="Fortizar">Fortizar</option>
												<option value="Faction_Fortizar">Faction Fortizar</option>
												<option value="Keepstar">Keepstar</option>
												<option value="Athanor">Athanor</option>
												<option value="Tatara">Tatara</option>
												<option value="Raitaru">Raitaru</option>
												<option value="Azbel">Azbel</option>
												<option value="Sotyio">Sotyio</option>
											</select>
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="corp">Corp:</label>
											<input type='text' name='corp' class="form-control" id="corp">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="alliance">Alliance:</label>
											<input type='text' name='alliance' class="form-control" id="alliance">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="power">Power: </label>
											<select name='power' class="form-control" id="power">
												<option value="Any">Any</option>
												<option value="High">High</option>
												<option value="Low">Low</option>
											</select>
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="fit">Fitting: </label>
											<input type='text' name='fit' class="form-control" id="fit">
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="moondata">Moon Data: </label>
											<select name='moondata' class="form-control" id="moondata">
												<option value="Any">Any</option>
												<option value="None">None</option>
												<option value="R4">R4</option>
												<option value="R8">R8</option>
												<option value="R16">R16</option>
												<option value="R32">R32</option>
												<option value="R64">R64</option>
												<option value="Double R64">Double R64</option>

											</select>
										</div>
									</div>

									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="vulnhourmin">Vuln Hour Min:</label>
											<select name='vulnhourmin' class="form-control" id="vulnhourmin">
												<option value=""></option>
												{%for i in range(0, 24)%}
												<option value="{{i}}">{{i}}:00</option>
												{%endfor%}
											</select>
										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="vulnhourmax">Vuln Hour Max:</label>
											<select name='vulnhourmax' class="form-control" id="vulnhourmax">
												<option value=""></option>
												{%for i in range(0, 24)%}
												<option value="{{i}}">{{i}}:00</option>
												{%endfor%}
											</select>

										</div>
									</div>
									<div class="col col-lg-6 col-md-6 col-sm-12">
										<div class="form-group">
											<label for="vulnday">Vuln Day:</label>
											<select name='vulnday' class="form-control" id="vulnday">
												<option value=""></option>
												<option value="Sunday">Sunday</option>
												<option value="Monday">Monday</option>
												<option value="Tuesday">Tuesday</option>
												<option value="Wednesday">Wednesday</option>
												<option value="Thursday">Thursday</option>
												<option value="Friday">Friday</option>
												<option value="Saturday">Saturday</option>
											</select>
										</div>
									</div>
									<div class="col col-lg-3 col-md-6 col-sm-12">
										<div class="form-group">
											<input type='submit' value='Submit' class="btn btn-success">
											<input type='reset' value='Reset' class="btn btn-danger">
										</div>
									</div>

								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
			<div class="table-responsive">
				<table class="table table-striped table-hover table-sm">
					<thead>
						<tr>
							<th>Region:</th>
							<th>System:</th>
							<th>Type:</th>
							<th>Name:</th>
							<th>Corp:</th>
							<th>Alliance:</th>
						</tr>
					</thead>
					<tbody>
						{% for citadel in results %}
						<tr onclick="openCitadelInfo('{{citadel._id}}')">
							<td>{{ citadel.region }}</td>
							<td>{{ citadel.system }}</td>
							<td>{{ citadel.type }}</td>
							<td>{{ citadel.citname }}</td>
							<td>{{ citadel.corp }}</td>
							<td>{{ citadel.alliance }}</td>
						</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</body>


<div role="dialog" tabindex="-1" class="modal fade" id="detailview">
<div class="modal-dialog modal-lg modal-dialog-centered" role="document">
   <div class="modal-content">
      <div class="modal-header bg-dark text-light">
         <h4 class="modal-title"><i class=""></i>Citadel Details</h4>
         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
         <span aria-hidden="true">Ã—</span>
         </button>
      </div>
      <div class="modal-body">
         <div class="row">
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalname">Name:</label>
                  <!--<p id='modalname'></p>-->
                  <input id="modalname" class="form-control" type="text" readonly>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modaltype">Type:</label>
                  <p id='modaltype'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalalliance">Alliance:</label>
                  <p id='modalalliance'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalcorp">Corp:</label>
                  <p id='modalcorp'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalregion">Region:</label>
                  <p id='modalregion'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalconstellation">Constallation:</label>
                  <p id='modalconstellation'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalsystem">System:</label>
                  <p id='modalsystem'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalpower">Power:</label>
                  <p id='modalpower'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalmoondata">Moon Data:</label>
                  <p id='modalmoondata'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalfit">Fit:</label>
                  <p id='modalfit'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalvuln">Vulnerability:</label>
                  <p id='modalvuln'></p>
               </div>
            </div>
            <div class="col-lg-4 col-md-6">
               <div class="form-group">
                  <label for="modalsubmitted">Date Submitted:</label>
                  <p id='modalsubmitted'></p>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>

	<script>
		function openCitadelInfo(id) {
			//Postpone until citadels are moved to database	
			$.ajax({
				url: "/citadel/" + id,
				type: "POST",
				data: ""
			}).done(function (response) {
				console.log(response)
				$('#detailview').modal('toggle');
				$('#modalname').text(response.citname)
				$('#modaltype').text(response.type)
				$('#modalalliance').text(response.alliance)
				$('#modalcorp').text(response.corp)
				$('#modalregion').text(response.region)
				$('#modalconstellation').text(response.constellation)
				$('#modalsystem').text(response.system)
				$('#modalpower').text(response.power)
				$('#modalmoondata').text(response.moondata)
				$('#modalfit').text(response.fit)
				$('#modalvuln').text(response.vulnerability.day + " " + response.vulnerability.hour + ":00")
				$('#modalsubmitted').text(response.lastSubmittedDate)
			});
		}
	</script>